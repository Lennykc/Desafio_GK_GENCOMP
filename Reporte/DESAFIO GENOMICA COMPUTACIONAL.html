<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>DESAFIO GENOMICA COMPUTACIONAL&lt;&sol;u&gt;</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="desafio-genomica-computacionalu">DESAFIO GENOMICA COMPUTACIONAL</u></h1>
<div style="text-align: right">
<h3 id="gabriel-krüger-carrasco">GABRIEL KRÜGER CARRASCO</h3>
<h3 id="doctorado-en-bioinformatica-y-biologia-de-sistemas">DOCTORADO EN BIOINFORMATICA Y BIOLOGIA DE SISTEMAS</h3>
</div>
<h2 id="tabla-de-contenidos">Tabla de contenidos</h2>
<ul>
<li><a href="#introduccion">INTRODUCCION</a></li>
<li><a href="#metodologia-y-resultados-preliminares">METODOLOGIA Y RESULTADOS PRELIMINARES</a>
<ul>
<li><a href="#flujo-de-trabajo">FLUJO DE TRABAJO</a></li>
<li><a href="#visualizacion-de-calidad-y-procesamiento-de-datos">VISUALIZACION DE CALIDAD Y PROCESAMIENTO DE DATOS</a></li>
<li><a href="#mapeo-de-reads-contra-referencia">MAPEO DE READS CONTRA REFERENCIA</a></li>
<li><a href="#analisis-filogenomico">ANALISIS FILOGENOMICA</a></li>
<li><a href="#analisis-de-comunidad">ANALISIS DE COMUNIDAD</a></li>
</ul>
</li>
<li><a href="#resultados">RESULTADOS</a></li>
<li><a href="#discusiones">DISCUSIONES</a></li>
<li><a href="#referencias">REFERENCIAS</a></li>
<li><a href="#anexos">ANEXOS</a></li>
</ul>
<h2 id="introduccion"><strong>INTRODUCCION</strong></h2>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>Las ómicas ayudan a poder entender muchas aristas de la biología, ecología y procesos biológicos que aún no tenemos noción de la inmensidad de información que aún falta por rescatar y poder estudiar, por lo que existen muchas estrategias a distinto nivel y orden de información, pasando desde la genómica, transcriptómica, proteómica y metabolómica para nombrar algunas directamente relacionada con el dogma centrar de la biología molecular. En este trabajo se estudia y analiza la ómica relacionada con la expresión génica, es decir la transcriptómica, pero a nivel de comunidad biológica. Esta estrategia busca evaluar la expresión de genes funcionales de una comunidad biológica a través de una metatranscriptómica, pero en estricto rigor, acotaremos este estudio para evaluar la presencia del virus asociado a la enfermedad covid-19.</p>
<p>El SARS-CoV-2, desde ahora en adelante será nombrado como CoV-2, es un tipo de coronavirus, específicamente beta-coronavirus, de hebra simple de ARN que actualmente ha dejado estragos en la salud pública mundial desde inicios del 2020 declarándose epidemia el 30 de enero del 2020 y solo un poco más de dos meses Pandemia. Por lo que evaluar la presencia del virus en entornos urbanos mediante metatranscriptómica, al ser un virus que su material genético está conformado por ARN esta estrategia permitirá secuenciar y detectar su presencia en el ambiente.
Como estudiantes del Doctorado en Bioinformática y Biología de Sistemas participamos voluntariamente en este desafío que pone aprueba nuestros conocimientos y límites para nuestra formación como futuros investigadores.</p>
<p>Como objetivo del desafío nos propusieron el análisis de 20 metatranscriptómica de origen urbano del Gran Santiago, el cual debemos dar como reporte a las siguientes preguntas:</p>
<ul>
<li>¿Podemos detectar CoV-2 en las muestras?</li>
<li>¿Podemos reconstruir los genomas? (asociado al virus)</li>
<li>¿Podemos detectar a que linaje pertenecen?</li>
<li>¿Dónde abundan, que variantes de CoV-2? (En que superficie y zona de la ciudad)</li>
<li>¿Hay alguna correlación geográfica con respecto al CoV-2 detectado?</li>
</ul>
<p>De esta forma elaborar un reporte con la metodología, resultados y discusiones.</p>
<hr>
<h2 id="metodologia-y-resultados-preliminares"><strong>METODOLOGIA Y RESULTADOS PRELIMINARES</strong></h2>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>Inicialmente, para el trabajo posterior, se indago en la metadata entregadas junto a las muestras de metatranscriptoma esta se simplifico extrayendo los datos que son útiles que correspondían a las muestras entregadas y así responder a las preguntas asociadas con el desafío. Un resumen se puede observar en la tabla 1.</p>
<center>
<p><strong>Tabla 1. Metadata asociada a cada muestras</strong>. Estableciendo la fecha, comuna de muestreo, zona de muestreo, elemento muestreado.</p>
<table>
<thead>
<tr>
<th><strong>Muestra</strong></th>
<th><strong>Fecha</strong></th>
<th><strong>Comuna</strong></th>
<th><strong>Sitio</strong></th>
<th><strong>Especimen</strong></th>
<th><strong>Tipo de Superficie</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>BC-0345795864</em></td>
<td>2020-05-05</td>
<td>La Florida</td>
<td>Metro Vicuña Mackena</td>
<td>Escalator handrail</td>
<td>Caucho</td>
</tr>
<tr>
<td><em>BC-0345795896</em></td>
<td>2020-05-04</td>
<td>Ñuñoa</td>
<td>PD335-Parada 1 / (M)</td>
<td>Seat</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797312</em></td>
<td>2020-04-13</td>
<td>Puente Alto</td>
<td>Farmacia solidaria Plaza de Puente Alto</td>
<td>Handrail</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797317</em></td>
<td>2020-04-20</td>
<td>Ñuñoa</td>
<td>Walmart</td>
<td>Handrail</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797602</em></td>
<td>2020-04-27</td>
<td>Ñuñoa</td>
<td>Walmart</td>
<td>Handrail</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797632</em></td>
<td>2020-04-27</td>
<td>Puente Alto</td>
<td>PF176-Parada 3 / (M) Plaza De Puente Alto</td>
<td>Horizontal pole</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797636</em></td>
<td>2020-04-13</td>
<td>Ñuñoa</td>
<td>PD335-Parada 1 / (M)</td>
<td>Horizontal pole</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797641</em></td>
<td>2020-04-13</td>
<td>Ñuñoa</td>
<td>Walmart</td>
<td>Handrail</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797645</em></td>
<td>2020-04-18</td>
<td><em>Home</em> (Ñuñoa)</td>
<td><em>Home</em> (Control)</td>
<td>Control</td>
<td>Desconocido</td>
</tr>
<tr>
<td><em>BC-0345797686</em></td>
<td>2020-04-27</td>
<td>Ñuñoa</td>
<td>PD335-Parada 1 / (M)</td>
<td>Seat</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797802</em></td>
<td>2020-04-20</td>
<td>Ñuñoa</td>
<td>Santander Bank</td>
<td>ATM</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797815</em></td>
<td>2020-04-27</td>
<td>La Florida</td>
<td>Metro Bellavista de la Florida</td>
<td>ATM</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797817</em></td>
<td>2020-04-13</td>
<td>La Florida</td>
<td>Metro Bellavista de la Florida</td>
<td>ATM</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345797839</em></td>
<td>2020-04-20</td>
<td>La Florida</td>
<td>Metro Vicuña Mackenna</td>
<td>Escalator handrail</td>
<td>Caucho</td>
</tr>
<tr>
<td><em>BC-0345798087</em></td>
<td>2020-05-05</td>
<td>La Florida</td>
<td>Metro Bellavista de la Florida</td>
<td>ATM</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345798943</em></td>
<td>2020-04-20</td>
<td>La Florida</td>
<td>PE1262-Parada 5 / (M)</td>
<td>Information board</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0345799013</em></td>
<td>2020-04-27</td>
<td>Puenta Alto</td>
<td>PF512-Parada 2 / (M)</td>
<td>Horizontal pole</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0361053718</em></td>
<td>2020-04-27</td>
<td>Macul</td>
<td>PD64-Parada 1 / Colegio San Marcos</td>
<td>Pole</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0361053744</em></td>
<td>2020-04-20</td>
<td>Ñuñoa</td>
<td>Medical Center</td>
<td>Door handle</td>
<td>Metal</td>
</tr>
<tr>
<td><em>BC-0361057091</em></td>
<td>2020-04-29</td>
<td>Ñuñoa</td>
<td>Medical Center</td>
<td>Door handle</td>
<td>Metal</td>
</tr>
</tbody>
</table>
</center>
<p>Los archivos de las muestras se almacenaron en un directorio exclusivo en un disco de 1TB denominado <i>e:</i> en el directorio <i>/mnt/e/Desafio_Genomica/muestras/</i> en cambio la metadata en <i>/mnt/e/Desafio_Genomica/informacion/</i>. Se establece el directorio de trabajo como <i>/mnt/e/Desafio_Genomica/</i> para la ejecución de todos los script que se utilizaran.</p>
<h3 id="flujo-de-trabajo"><strong>FLUJO DE TRABAJO</strong></h3>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>El flujo de trabajo para analizar toda esta informacion (Figura 1.) inicia con el análisis de calidad de las secuencias, para determinar los parámetros de corte y filtro mediante trimming, para posteriormente dividir la línea de análisis en una global y otra directa, la línea global abarcara la diversidad taxonómica y observar de forma visual, no funcional pero complementaria. En cambio la directa irá a mapear las reads contra el genoma de referencia para CoV-2. Finalizando con un análisis de profundidad, cobertura para determinar mediante consenso en las muestras, el linaje que pertenece mediante pangolín y GISAID, graficando finalmente con llama los SPNs asociados a los linaje.
Para concluir, se sumaron las muestras de infectados en las fechas tempranas de la pandemia trabajadas en prácticos anteriores para visualizar el mapa de CoV-2 de Santiago en árbol filogenético y en un mapa de la ciudad con la muestras trabajadas.</p>
<center>
<p><img src="https://cdn.discordapp.com/attachments/739926071755145350/786615702106537994/WorkFlow.png" alt="IMAGEN"></p>
</center>
<p><strong>Figura 1. Flujo de Trabajo realizado para llevar a cabo el desafío.</strong> Se dividió en 4 grandes secciones. En celeste la visualización de la calidad de la secuenciación, en violeta el mapeo y ensamble según el genoma de referencia, en verde el análisis de la búsqueda de linaje y creación de árbol filogenético con las muestras de Santiago y en naranjo el análisis de diversidad y cuantificación de la comunidad del microbioma urbano.</p>
<p>Los programas utilizados y su versión se adjuntan en la tabla 2. El trabajo se dividió en varias plataformas siendo la más utilizada Unix mediante consola en Ubuntu 20.04 LTS, seguida de Python v3.8.5 mediante interfaz grafica de anaconda por medio de Jupyter-Lab v2.2.6.</p>
</div>
<center>
<p><strong>Tabla 2. Paquetes utilizados en durante el Desafío</strong></p>
<table>
<thead>
<tr>
<th><strong>Paquete</strong></th>
<th><strong>Versión</strong></th>
<th><strong>Workflow</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>fastQC</td>
<td>v0.11.9</td>
<td>Calidad y Procesamiento</td>
</tr>
<tr>
<td>MultiQC</td>
<td>v1.9</td>
<td>Calidad y Procesamiento</td>
</tr>
<tr>
<td>Trim_Galore</td>
<td>v0.6.6</td>
<td>Calidad y Procesamiento</td>
</tr>
<tr>
<td>Bowtie2</td>
<td>v2.3.5.1</td>
<td>Mapeo y Ensamble</td>
</tr>
<tr>
<td>Samtools</td>
<td>v1.11</td>
<td>Mapeo y Ensamble</td>
</tr>
<tr>
<td>Bcftools</td>
<td>v1.11</td>
<td>Mapeo y Ensamble</td>
</tr>
<tr>
<td>Seqtk</td>
<td>v1.3-r106</td>
<td>Mapeo y Ensamble</td>
</tr>
<tr>
<td>Mafft</td>
<td>v7.475</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>IQ-Tree</td>
<td>v1.6.12</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>Pangolin</td>
<td>v1.1.14</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>Llama</td>
<td>v0.1</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>BEAST</td>
<td>v1.10.4</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>BEAUti</td>
<td>v1.10.4</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>TreeAnnotator</td>
<td>v1.10.4</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>TRACER</td>
<td>v1.7.1</td>
<td>Filogenomica</td>
</tr>
<tr>
<td>FigTree</td>
<td>v1.4.4</td>
<td>Filogenomica</td>
</tr>
</tbody>
</table>
</center>
<h3 id="visualizacion-de-calidad-y-procesamiento-de-datos"><strong>VISUALIZACION DE CALIDAD Y PROCESAMIENTO DE DATOS</strong></h3>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>Los datos de metatranscriptómica de las 20 muestras fueron analizados con FastQC mediante consola para generar un reporte con el programa Multiqc, como se explica en el siguiente código.</p>
<details>
<summary>
<i> Codigo fastqc </i>
</summary>
<p>
<pre><code class="language-console"><div>(fastqc)foo@bar:/mnt/e/Desafio_Genomica$ bash all_fastqc.sh ./muestras/
</div></code></pre>
<p>Cuyo script es el siguiente.</p>
<pre><code class="language-shell"><div><span class="hljs-meta"> #</span><span class="bash">!/bin/bash/</span>
<span class="hljs-meta"> #</span><span class="bash"><span class="hljs-comment"># all_fastqc.gk $1</span></span>
<span class="hljs-meta"> #</span><span class="bash"><span class="hljs-comment"># script.gk 23.nov.2020</span></span>
 arg=$1 #Como argumento se solicita el directorio objetivo
<span class="hljs-meta"> 
 #</span><span class="bash"><span class="hljs-comment"># Se crea un archivo lista con todos los elementos fastq del directorio objetivo</span></span>
 ls ${arg}*.fastq &gt; files
<span class="hljs-meta"> #</span><span class="bash"><span class="hljs-comment"># Se crea directorio destino</span></span>
 mkdir ./fastqc
 
 while IFS= read line; do
   
<span class="hljs-meta">   #</span><span class="bash"><span class="hljs-comment"># Ejecuta FastQC</span></span>
   fastqc ${line}
   
<span class="hljs-meta">   #</span><span class="bash"><span class="hljs-comment"># Se mueven los output al directorio de salida</span></span>
   mv ${line}c.html ./fastqc/${line}c.html
   mv ${line}c.zip ./fastqc/${line}c.zip
 done &lt; files
<span class="hljs-meta"> 
 #</span><span class="bash"><span class="hljs-comment"># Se elimina los archivos temporales</span></span>
 rm files
<span class="hljs-meta"> 
 #</span><span class="bash"><span class="hljs-comment"># Se ejecuta MultiQC en el directorio de salida</span></span>
 multiqc ./fastq/
</div></code></pre>
</p>
</details>
<p>Este pequeño código a medida que se va ejecutando FastQC va ordenando el directorio como corresponde para evitar perdidas de archivos y acumulación de estos. Al finalizar el bucle while se ejecuta MultiQC para generar un reporte masivo entre todos los análisis de las muestras.</p>
<div style="text-align: right"> 
<p><strong>El reporte se muestra acontinuacion <i> <a href="multiqc_report/fastqc_report/multiqc_report.html">MULTIQC REPORT</a></strong> </i></p>
</div>
<p>Del reporte se puede rescatar la magnitud de cantidad de reads que van desde 21.7 Millones hasta 34.0 Millones, también la calidad de secuenciación de promedio sobre 28 <i>Phred Score</i> lo que promete rescatar muy buena información al tener que cortar solo los adaptadores y no tomar encuentra que se perderá información al filtrar por calidad. En cambio, un estadístico que llamo mucho la atención es la cantidad de reads duplicados, desde un 80.2 a 96.5% haciendo inferir una baja diversidad en la comunidad del microbioma.</p>
<p>El siguiente paso para depurar las muestras es aplicar trimming para cortar y filtrar las reads, quitando los adaptadores y evaluando su calidad para quedar con aquellas que  superen el umbral designado.</p>
<p>Para ello aplicamos el siguiente código en bash.</p>
<details>
<summary>
<i> Codigo trim Galore </i>
</summary>
<p>
<pre><code class="language-console"><div> (trim-galore)foo@bar:/mnt/e/Desafio_Genomica$ bash trim_all.sh ./muestras/
</div></code></pre>
<pre><code class="language-sh"><div> <span class="hljs-comment">#!/bin/bash/</span>
 <span class="hljs-comment">## G_K/script 23.nov.2020</span>
 <span class="hljs-comment">## trim_all.gk $1</span>
 <span class="hljs-comment">## $1 dir ./fastq/</span>
 arg=<span class="hljs-variable">$1</span> <span class="hljs-comment">#Como argumento se solicita el directorio objetivo</span>

 <span class="hljs-comment">## Se crea un archivo lista con todos los elementos 1.fastq del directorio objetivo</span>
 ls <span class="hljs-variable">${arg}</span>*1.fastq &gt; files
 
 <span class="hljs-comment">## Se crean los directorios de salida</span>
 mkdir ./trim
 mkdir ./trim_report
 mkdir ./trim_fastqc
 
 <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>

   <span class="hljs-comment">## Se guarda la variable del read 2</span>
   line_2=<span class="hljs-variable">${line%*1.fastq}</span>2.fastq
 
   <span class="hljs-comment">## Se ejecuta trim_galore con los siguientes parametros: calidad &gt;25 / adaptadores illumina / cortar N / largo permitido &gt;50 / paired / </span>
   trim_galore --quality 25 --fastqc --illumina --trim-n --length 50 --paired --cores 4 <span class="hljs-variable">${line}</span> <span class="hljs-variable">${line_2}</span>

   <span class="hljs-comment">## Se mueven los archivos generados a los directorios de salida</span>
   mv <span class="hljs-variable">${line%*.fastq}</span>.fq ./trim/<span class="hljs-variable">${line%*.fastq}</span>.fq
   mv <span class="hljs-variable">${line_2%*.fastq}</span>.fq ./trim/<span class="hljs-variable">${line_2%*.fastq}</span>.fq
   mv <span class="hljs-variable">${line}</span>_trimming_report.txt ./trim_report/<span class="hljs-variable">${line}</span>_trimming_report.txt
   mv <span class="hljs-variable">${line_2}</span>_trimming_report.txt ./trim_report/<span class="hljs-variable">${line_2}</span>_trimming_report.txt
   mv <span class="hljs-variable">${line%*.fastq}</span>_fastqc.html ./trim_fastqc/<span class="hljs-variable">${line%*.fastq}</span>_fastqc.html
   mv <span class="hljs-variable">${line_2%*.fastq}</span>_fastqc.html ./trim_fastqc/<span class="hljs-variable">${line_2%*.fastq}</span>_fastqc.html
   mv <span class="hljs-variable">${line%*.fastq}</span>_fastqc.zip ./trim_fastqc/<span class="hljs-variable">${line%*.fastq}</span>_fastqc.zip
   mv <span class="hljs-variable">${line_2%*.fastq}</span>_fastqc.zip ./trim_fastqc/<span class="hljs-variable">${line_2%*.fastq}</span>_fastqc.zip
 <span class="hljs-keyword">done</span> &lt; files

 <span class="hljs-comment">## Se eliminan archivos temporales</span>
 rm files
</div></code></pre>
</p>
</details>
<p>Una ves terminado el programa Trim_Galore, se procese a ejecutar MultiQC en el directorio /trim_fasqc/ como muestra el siguiente código.</p>
<details>
<summary>
<i> Codigo multiqc trim </i>
</summary>
<p>
<pre><code class="language-console"><div> (fasqc)foo@bar:/mnt/e/Desafio_Genomica$ multiqc ./trim_fastqc/
</div></code></pre>
</p>
</details>
<div style="text-align: right"> 
<p><strong>El reporte se muestra acontinuacion <i> <a href="multiqc_report/trim_multiqc/multiqc_report.html">TRIM MULTIQC REPORT</a></strong> </i></p>
</div>
<p>Corroborando la eliminación de todos los adaptadores de las reads y que la mayoría del resto de los estadísticos se mantuvieron relativamente estáticos o con poca variación. Con este preprocesamiento de las reads, se puede trabajar con el mapeo y análisis de diversidad como siguiente parte del flujo de trabajo.</p>
<h3 id="mapeo-de-reads-contra-referencia"><strong>MAPEO DE READS CONTRA REFERENCIA</strong></h3>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>El programa para realizar el mapeo es bowtie2, el cual necesita indexar una referencia para poder realizar el mapeo. El genoma de referencia se descarga desde NCBI, este genoma de CoV-2 es utilizada para los estudios genómicos asociados al virus. NC_045512.2 es el genoma que hace referencia al caso 0, asilada desde un paciente desde fluidos de lavado broncoalveolar documentado el 2020-12-30.</p>
<p>Para crear el índice de referencia se ejecuta el siguiente código.</p>
<details>
<summary>
<i> Codigo bowtie2 referencia index </i>
</summary>
<p>
<pre><code class="language-console"><div>  (bwt2)foo@bar:/mnt/e/Desafio_Genomica$ mkdir ./referencia/
  (bwt2)foo@bar:/mnt/e/Desafio_Genomica$ cd ./referencia/
  (bwt2)foo@bar:/mnt/e/Desafio_Genomica/referencia/$ bowtie2-build NC_045512.2_ref.fasta ref_index
</div></code></pre>
</p>
</details>
<p>Estos archivos creados por el programa son necesarios para que se logre el mapeo de todas las reads y puedan ser anotadas para su posterior análisis y ensamble.</p>
<p>Se ejecuta bowtie2 en un script, como detallo a continuación.</p>
<details>
<summary>
<i> Codigo bowtie2 mapeo </i>
</summary>
<p>
<pre><code class="language-console"><div>  (bwt2)foo@bar:/mnt/e/Desafio_Genomica/referencia/$ cd ..
  (bwt2)foo@bar:/mnt/e/Desafio_Genomica$ bash bwt2.sh ./trim/
</div></code></pre>
<pre><code class="language-sh"><div><span class="hljs-meta">#!/bin/bash/</span>
<span class="hljs-comment">## G_K/script 24.nov.2020</span>
<span class="hljs-comment">## bwt2.gk $1</span>
<span class="hljs-comment">## $1 dir ./trim/</span>
arg=<span class="hljs-variable">$1</span>

<span class="hljs-comment">## Se crea un archivo lista con todos los elementos .bam del directorio objetivo</span>
ls <span class="hljs-variable">${arg}</span>*1.fq &gt; files

<span class="hljs-comment">## Se crean los directorios de salida</span>
mkdir ./mapeo

<span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
    <span class="hljs-comment">## Se guarda la variable del read 2</span>
	line_2=<span class="hljs-variable">${line%*1_val_1.fq}</span>2_val_2.fq
    
    <span class="hljs-comment">## Se guarda la variable de salida</span>
	output=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line_2</span>&quot;</span> | grep -Eo <span class="hljs-string">&quot;BC-[0-9]{10}&quot;</span>)

    <span class="hljs-comment">## Se utiliza esta forma de llamar al programa para ahorrar espacio de disco y que utilice RAM para este proceso</span>
	bowtie2 -x ./referencia/ref_index -1 <span class="hljs-variable">${line}</span> -2 <span class="hljs-variable">${line_2}</span> -p 2  | samtools view -bS | samtools sort &gt; <span class="hljs-variable">${output}</span>.bam
    
    <span class="hljs-comment">## Se mueven los archivos de salida al correspondiente directorio</span>
    mv <span class="hljs-variable">${output}</span>.bam ./mapeo/<span class="hljs-variable">${output}</span>.bam
    
    <span class="hljs-comment">## Print de salida</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Mapeo de <span class="hljs-variable">${line}</span> listo&quot;</span>
<span class="hljs-keyword">done</span> &lt; files

<span class="hljs-comment">## Se eliminan archivos temporales</span>
rm files
</div></code></pre>
</p>
</details>
<p>Terminado el mapeo se puede obtener las estadísticas de este con la parámetro <em>stats</em> de samtools.</p>
<details>
<summary>
<i> Codigo samtools stats </i>
</summary>
<p>
<pre><code class="language-console"><div>  (bwt2)foo@bar:/mnt/e/Desafio_Genomica$ bash stats.sh ./mapeo/
</div></code></pre>
<pre><code class="language-sh"><div><span class="hljs-meta">#!/bin/bash/</span>
<span class="hljs-comment">## G_K/script 24.nov.2020</span>
<span class="hljs-comment">## stats.gk $1</span>
<span class="hljs-comment">## $1 dir ./mapeo/</span>
arg=<span class="hljs-variable">$1</span>

<span class="hljs-comment">## Se crea un archivo lista con todos los elementos .bam del directorio objetivo</span>
ls <span class="hljs-variable">${arg}</span>*.bam &gt; files

<span class="hljs-comment">## Se crean los directorios de salida</span>
mkdir ./mapeo_stats

<span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
    <span class="hljs-comment">## Se guarda la variable de salida</span>
	output=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | grep -Eo <span class="hljs-string">&quot;BC-[0-9]{10}&quot;</span>)

	<span class="hljs-comment">## Se ejecuta samtools stats</span>
    samtools stats <span class="hljs-variable">${line}</span> &gt; <span class="hljs-variable">${output}</span>_stats.txt
	
    <span class="hljs-comment">## Se mueven los archivos de salida al correspondiente directorio</span>
    mv <span class="hljs-variable">${output}</span>_stats.txt ./mapeo_stats/<span class="hljs-variable">${output}</span>_stats.txt
    
    <span class="hljs-comment">## Print de salida</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">${line}</span> stats listo&quot;</span>
<span class="hljs-keyword">done</span> &lt; files
<span class="hljs-comment">## Se eliminan archivos temporales</span>
rm files
</div></code></pre>
</p>
</details>
<p>De estos informes de estadísticas <strong>(Anexo <em><a href="anexos/stats.html">Stats</a></em>)</strong> se puede observar parámetros por ejemplo de mapeo y cobertura del genoma, en este caso, de CoV-2.
Seguido del análisis de las estadísticas entregadas por samtools, se prosiguió a la generación de los archivos vcf para complementar el análisis de cobertura y profundidad de mapeo, detectando así cada cambio que tiene las reads mapeadas con la referencia, en el mismo script se generan los archivos fastas consenso para el próximo análisis. Esto se logro gracias el programa bcftools que fue ejecutado mediante el siguiente script.</p>
<details>
<summary>
<i> Codigo bcftools</i>
</summary>
<p>
<pre><code class="language-console"><div>  (bwt2)foo@bar:/mnt/e/Desafio_Genomica$ bash bcf.sh ./mapeo/
</div></code></pre>
<pre><code class="language-sh"><div><span class="hljs-meta">#!/bin/bash/</span>
<span class="hljs-comment">## G_K/script 25.nov.2020</span>
<span class="hljs-comment">## bcf.gk $1</span>
<span class="hljs-comment">## $1 dir ./mapeo/</span>
arg=<span class="hljs-variable">$1</span>

<span class="hljs-comment">## Se crean los directorios de salida</span>
mkdir ./VCF_files
mkdir ./Fasta_finales 

<span class="hljs-comment">## Se crea un archivo lista con todos los elementos .bam del directorio objetivo</span>
ls <span class="hljs-variable">${arg}</span>*.bam &gt; files

<span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
	output=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | grep -Eo <span class="hljs-string">&quot;BC-[0-9]{10}&quot;</span>)

    <span class="hljs-comment">## Creacion de archivos vcf</span>
	bcftools mpileup -f referencia.fasta <span class="hljs-variable">${line}</span> &gt; <span class="hljs-variable">${output}</span>.vcf
	<span class="hljs-comment">## Creacion de archivo fasta consenso</span>
    bcftools call -c <span class="hljs-variable">${output}</span>.vcf | vcfutils.pl vcf2fq | seqtk seq -aQ64 -q20 &gt; <span class="hljs-variable">${output}</span>.fasta

	<span class="hljs-comment">## Se mueven los archivos de salida al correspondiente directorio</span>
    mv <span class="hljs-variable">${output}</span>.vcf ./VCF_files/<span class="hljs-variable">${output}</span>.vcf
	mv <span class="hljs-variable">${output}</span>.fasta ./Fasta_finales/<span class="hljs-variable">${output}</span>.fasta
	
    <span class="hljs-comment">## echo de salida output</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">${output}</span> listo&quot;</span>
<span class="hljs-keyword">done</span> &lt; files
rm files
</div></code></pre>
</p>
</details>
<p>Con los archivos .vcf podemos observar todos los SNPs presentes en cada muestra y poder determinar junto con los análisis filogenéticos los SNPs correspondientes a las variantes detectadas por los programas como pangolin y llama observando la profundidad de secuenciación obtenida para cada muestreo.</p>
<h3 id="analisis-filogenomico"><strong>ANALISIS FILOGENOMICO</strong></h3>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>El análisis filogenómico se hace en base a los archivos .fasta entregado por el script bcftools, con ellos se realiza una concatenación entre todos los fasta para generar un compilado de secuencias ensambladas y se realiza un alineamiento multiple con mafft, para posteriormente construir un árbol global con iqtree y analizar las variantes con pangolin, como se detalla a continuación en el siguiente código.</p>
<details>
<summary>
<i> Codigo alineamiento, arbol y deteccion de variantes</i>
</summary>
<p>
<pre><code class="language-console"><div>(mafft)foo@bar:/mnt/e/Desafio_Genomica$ bash phy.sh ./Fasta_finales/
</div></code></pre>
<pre><code class="language-sh"><div><span class="hljs-meta">#!/bin/bash/</span>
<span class="hljs-comment">## G_K/script 27.nov.2020</span>
<span class="hljs-comment">## phy.gk $1</span>
arg=<span class="hljs-variable">$1</span> <span class="hljs-comment">#./Fasta_finales/</span>

<span class="hljs-comment">## Se crean los directorios de salida</span>
mkdir Alineamiento

<span class="hljs-comment">## Se crean los archivo de compilacion de fasta</span>
touch compilate.fasta

<span class="hljs-comment">## Se crea un archivo lista con todos los elementos .fasta del directorio objetivo</span>
ls <span class="hljs-variable">${arg}</span>*.fasta &gt; files

<span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
	<span class="hljs-comment">## Se remplaza el encabezado</span>
    input=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | grep -Eo <span class="hljs-string">&quot;BC-[0-9]{10}&quot;</span>)
	cat <span class="hljs-variable">${line}</span> | sed <span class="hljs-string">&quot;s/NC_045512.2/<span class="hljs-variable">${input}</span>/&quot;</span> &gt; <span class="hljs-variable">${input}</span>.fasta2
    <span class="hljs-comment">## Se añade al archivo compilado</span>
	cat <span class="hljs-variable">${input}</span>.fasta2 &gt;&gt; compilate.fasta
    <span class="hljs-comment">## Se elimina el archivo transitorio</span>
    rm <span class="hljs-variable">${input}</span>.fasta2
<span class="hljs-keyword">done</span> &lt; files
<span class="hljs-comment">## Se elimina el archivo temporal</span>
rm files

<span class="hljs-comment">## Se mueve el archivo de salida al directorio de salida</span>
mv compilate.fasta ./Alineamiento/compilate.fasta

<span class="hljs-comment">## Cambiamos directorio para generar los archivos</span>
<span class="hljs-built_in">cd</span> ./Alineamiento/

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ALINEAMIENTO&quot;</span>
mafft --auto compilate.fasta &gt; alignment.fasta

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;PANGOLIN&quot;</span>
pangolin compilate.fasta --outfile compilate.csv --write-tree -t 6

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;IQTREE&quot;</span>
iqtree -s alignment.fasta -nt 6

</div></code></pre>
</p>
</details>
<p>Se modifican los nombres de salida de algunos archivos de forma manual a metadata.csv y global.tree para que el programa <em>llama</em> pueda funcionar correctamente. De esta forma ejecutamos el siguiente código en el directorio de <em>./Alineamiento</em></p>
<details>
<summary>
<i> Codigo llama </i>
</summary>
<p>
<pre><code class="language-console"><div>(llama)foo@bar:/mnt/e/Desafio_Genomica$ cd ./Alimneamiento
(llama)foo@bar:/mnt/e/Desafio_Genomica/Alimneamiento$ llama -i metadata.csv -f alignment.fasta -d ./ --data-column name --lineage-representatives --number-of-representatives 7
</div></code></pre>
</p>
</details>
<p>Pangolin finalmente entregara una metadata asociada a la variante encontrada la cual se añadirá a la metadata general de trabajo como linaje. Para determinar el clado se trabaja con la plataforma online de <a href="https://www.gisaid.org/epiflu-applications/covsurver-mutations-app/">GISAID</a>, subimos el archivo <em>compilate.fasta</em> y el resultado sera agregado a la metadata de trabajo como clado.</p>
<p>Llama entregara información sobre los SNPs, mediante una infografía resumida <a href="">Resultados</a> donde podemos identificar cada SNPs y compararlos con los archivos .vcf para mejorar el análisis de los SNPs.</p>
<p>Finalmente, los datos vistos en el practico de filogenia de Genómica Computacional y se extraen datos y genomas de las muestras de Santiago, Chile. Para ello se toman los mismos parámetros de la metadata de trabajo y se concatena la metadata y los genomas en dos archivos, en metadata_cov.tsv (<em><a href="./anexos/metadata.html">Anexos metadatas</a></em> y en )compilado_cov.fasta (<em><a href="./anexos/secuencia.html">Anexos secuencias</a></em>). Con estos archivos se procede a crear un archivo .xml en BEAUti con los tips de anotación de las fechas de muestreo incorporando la metadata, se utiliza un prior de crecimiento exponencial con taza de crecimiento y random tree, se deja los tree prior en default y las iteraciones se establecen en 500 millones con generación de log parameter cada 1000. Con el archivo .xml se ejecuta BEAST y luego de que termine sus iteraciones se revisaron sus parámetros con TRACER y cerciorar que los indicadores estadísticos estén correctos se elige el árbol con los mayores indices para importarle la metada y poder observar la distribución de las muestras junto a las muestras de Santiago.</p>
<hr>
<h2 id="resultados"><strong>RESULTADOS</strong></h2>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>De las muestras de metatranscriptómica fue posible mapear contra el genoma de referencia NC_045512.2 en cada muestra entregada, por lo que si fue posible detectar CoV-2. Esto fue posible observar en los datos estadísticos que muestra samtools después de ejecutar bowtie2. En la tabla 3 nos arrojo datos esperados, al ser una metatranscriptómica y observar la magnitud de reads repetidos, los porcentajes de reads mapeados no superan el 1.15% del total de reads secuenciados, con un valor mínimo de 0,00085% en la muestra BC-0345795896. En la cobertura contra el genoma de referencia, algunas muestras lograron mapear hasta 2832x veces el genoma, rondando en valores generalmente entre 14 y 92x.
Valores que permitieron reconstruir el genoma hasta sobre 95.5% llegando a valores ~99.9% <a href="./Anexo/Mapa.html">Anexo Mapa de Coberturas</a>, las muestras que tienen una cobertura entre ~2 y ~6 no alcanzan un 90% de completitud. En conclusion, fue posible detectar y reconstruir el genoma de CoV-2 en las muestras urbanas de Santiago. Se tomaran encuentra aquellos genomas clasificados por GISAID como Completos de normal y alta cobertura para los siguientes análisis.</p>
<center>
<p><strong>Tabla 3. Análisis de estadísticos de cobertura y completitud del genoma.</strong> Proporción de reads mapeados contra los totales, cobertura de respecto al genoma de referencia y calidad de la reconstrucción del genoma.*</p>
<table>
<thead>
<tr>
<th><strong>Muestra</strong></th>
<th><strong>Reads Totales</strong></th>
<th><strong>Read Mapeados</strong></th>
<th><strong>Porcentajes de reads mapeados</strong></th>
<th><strong>Bases mapeadas</strong></th>
<th><strong>Cobertura</strong></th>
<th><strong>Profundidad Promedio</strong></th>
<th><strong>N%</strong></th>
<th><strong>Genoma[pb]</strong></th>
<th><strong>Status GISAID**</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>BC-0345795864</em></td>
<td>52'628'798</td>
<td>1'319</td>
<td>0,0025%</td>
<td>186'064</td>
<td>6,4153x</td>
<td>6.2207x</td>
<td>10.1503%</td>
<td>26839</td>
<td>Incompleto baja covertura</td>
</tr>
<tr>
<td><em>BC-0345795896</em></td>
<td>57'451'448</td>
<td>490</td>
<td>8,5e-4%</td>
<td>67'101</td>
<td>2,3135x</td>
<td>2.2429x</td>
<td>35.7992%</td>
<td>19171</td>
<td>Incompleto baja covertura</td>
</tr>
<tr>
<td><em>BC-0345797312</em></td>
<td>59'128'090</td>
<td>838</td>
<td>0,0014%</td>
<td>116'308</td>
<td>4,0102x</td>
<td>3.8891x</td>
<td>18.2344%</td>
<td>24416</td>
<td>Incompleto baja covertura</td>
</tr>
<tr>
<td><em>BC-0345797317</em></td>
<td>63'805'850</td>
<td>965</td>
<td>0,0015%</td>
<td>131'525</td>
<td>4,5348x</td>
<td>4.3975x</td>
<td>18.3105%</td>
<td>24399</td>
<td>Incompleto baja covertura</td>
</tr>
<tr>
<td><em>BC-0345797602</em></td>
<td>67'748'216</td>
<td>1'856</td>
<td>0,0027%</td>
<td>262'640</td>
<td>9,0556x</td>
<td>8.7809x</td>
<td>4.41304%</td>
<td>28548</td>
<td>Incompleto covertura normal</td>
</tr>
<tr>
<td><strong>BC-0345797632</strong></td>
<td>64'008'202</td>
<td>8'224</td>
<td>0,0128%</td>
<td>1'173'429</td>
<td>40,458x</td>
<td>39.229x</td>
<td>0.17742%</td>
<td>29818</td>
<td>Completo  alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345797636</strong></td>
<td>66'723'700</td>
<td>2'902</td>
<td>0,0043%</td>
<td>407'785</td>
<td>14,060x</td>
<td>13.634x</td>
<td>1.05788%</td>
<td>29555</td>
<td>Completo covertura normal</td>
</tr>
<tr>
<td><strong>BC-0345797641</strong></td>
<td>63'171'532</td>
<td>9'150</td>
<td>0,0144%</td>
<td>1'344'597</td>
<td>46,360x</td>
<td>44.951x</td>
<td>0.06695%</td>
<td>29852</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345797645</strong></td>
<td>48'683'998</td>
<td>558'306</td>
<td>1,1467%</td>
<td>82'148'765</td>
<td>2'832,4x</td>
<td>2'656.5x</td>
<td>0.06025%</td>
<td>29853</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><em>BC-0345797686</em></td>
<td>64'567'526</td>
<td>754</td>
<td>0,0011%</td>
<td>105'141</td>
<td>3,6251x</td>
<td>3.5159x</td>
<td>19.7482%</td>
<td>23972</td>
<td>Incompleto baja covertura</td>
</tr>
<tr>
<td><strong>BC-0345797802</strong></td>
<td>42'943'176</td>
<td>147'182</td>
<td>0.3427%</td>
<td>21'029'289</td>
<td>725,07x</td>
<td>703.12x</td>
<td>0.04352%</td>
<td>29858</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345797815</strong></td>
<td>54'277'256</td>
<td>10'390</td>
<td>0,0191%</td>
<td>1'503'965</td>
<td>51,855x</td>
<td>50.284x</td>
<td>0.12721%</td>
<td>29833</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345797817</strong></td>
<td>60'955'410</td>
<td>18'895</td>
<td>0,0309%</td>
<td>2'694'216</td>
<td>92,894x</td>
<td>90.078x</td>
<td>0.05691%</td>
<td>29854</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345797839</strong></td>
<td>64'648'716</td>
<td>8'557</td>
<td>0,0132%</td>
<td>1'230'510</td>
<td>42,426x</td>
<td>41.137x</td>
<td>0.06695%</td>
<td>29851</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345798087</strong></td>
<td>49'684'946</td>
<td>4'681</td>
<td>0,0094%</td>
<td>661'285</td>
<td>22,800x</td>
<td>22.111x</td>
<td>0.32138%</td>
<td>29775</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0345798943</strong></td>
<td>60'875'176</td>
<td>3'441</td>
<td>0,0056%</td>
<td>492'162</td>
<td>19,969x</td>
<td>16.452x</td>
<td>1.69060%</td>
<td>29366</td>
<td>Completo covertura normal</td>
</tr>
<tr>
<td><strong>BC-0345799013</strong></td>
<td>64'266'166</td>
<td>11'222</td>
<td>0,0174%</td>
<td>1'596'999</td>
<td>55,063x</td>
<td>53.398x</td>
<td>0.03682%</td>
<td>29860</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0361053718</strong></td>
<td>56'723'540</td>
<td>10'253</td>
<td>0,0180%</td>
<td>1'478'615</td>
<td>50,981x</td>
<td>49.434x</td>
<td>0.18079%</td>
<td>29814</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0361053744</strong></td>
<td>59'184'074</td>
<td>37'031</td>
<td>0,0625%</td>
<td>5'417'400</td>
<td>189,78x</td>
<td>181.11x</td>
<td>0.04351%</td>
<td>29859</td>
<td>Completo alta covertura</td>
</tr>
<tr>
<td><strong>BC-0361057091</strong></td>
<td>58'409'500</td>
<td>36'843</td>
<td>0,0630%</td>
<td>5'350'695</td>
<td>184.48x</td>
<td>178.90x</td>
<td>0.58250%</td>
<td>29697</td>
<td>Completo alta covertura</td>
</tr>
</tbody>
</table>
</center>
<p>* Muestras en negritas: Genomas seleccionados para siguientes ensayos.</p>
<p>**<a href="www.gisaid.org">Parámetros establecidos por GISAID para determinar el cumplimiento de calidad de un genoma de CoV-2</a></p>
<p>De 20 muestras se filtraron a 14, es con estas ultimas que se realiza el análisis filogenómico contra la referencia, utilizando pangolin, llama y la base de datos de GISAID determinando linaje y clado al que pertenecen el CoV-2 asociado a cada muestra. La tabla 4 resume los resultados obtenidos para cada muestra, destacando que pangolin y llama detectaron los SNPs asociado al linaje B.1 para todas las muestras. En cambio, la base de datas de GISAID asoció para la mayoría de las muestras al clado GH, exceptuando 4 muestras (BC-0345797636, BC-0345797641, BC-0345797839 y BC-0345798087). GISAID asocia SNPs específicos y reportados para asignar una variante, por lo que incluyendo sus estadísticos, GISAID no asocio un clado a estas muestras, muy posiblemente al encontrar regiones de N en el genoma.</p>
<center>
<p><strong>Tabla 4. Asignacion de linaje y clado de los genomas seleccionados.</strong></p>
<table>
<thead>
<tr>
<th><strong>Muestra</strong></th>
<th><strong>Linaje</strong></th>
<th><strong>Clado</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>BC-0345797632</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797636</em></td>
<td>B.1</td>
<td>OTHER</td>
</tr>
<tr>
<td><em>BC-0345797641</em></td>
<td>B.1</td>
<td>OTHER</td>
</tr>
<tr>
<td><em>BC-0345797645</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797802</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797815</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797817</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797839</em></td>
<td>B.1</td>
<td>OTHER</td>
</tr>
<tr>
<td><em>BC-0345798087</em></td>
<td>B.1</td>
<td>OTHER</td>
</tr>
<tr>
<td><em>BC-0345798943</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345799013</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0361053718</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0361053744</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0361057091</em></td>
<td>B.1</td>
<td>GH</td>
</tr>
</tbody>
</table>
</center>
<p>Con la generación de una tabla complementada con los datos obtenidos de cobertura, profundidad y completitud del genoma se puede observar y caracterizar la abundancia y que superficies esta mas presente CoV-2. En la Tabla completa (Tabla 6) se compilo toda la información recolectada, pudiendo determinar que la superficie donde se presenta mas CoV-2 es la metálica, de esta destacan los cajeros automáticos (ATM) y manillas de puerta.</p>
<h2 id="discusiones"><strong>DISCUSIONES</strong></h2>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<p>La información levantada desde estos metatranscriptómicas son esenciales para el entendimiento y comportamiento del virus CoV-2 en el ambiente urbano, siendo en la técnica no del todo eficiente, ya que el virus en un ambiente no de hospedero no posee metabolismo, por lo que la técnica de transcriptómica no esta siendo utilizada para la finalidad de detectar expresión o genes como normalmente es usada, si no que en este caso esta siendo usada para detectar un genoma viral de ARN que esta en la posibilidad de estar latente en el ambiente, es por esto que se necesita una capacidad no menor de secuenciación con una muy buena profundidad de secuenciación para poder alcanzar a detectarlo. Y es ahi donde llegamos a la respuesta de la primera pregunta <em><strong>¿Podemos detectar CoV-2 en las muestras?</strong></em> ¿Es capaz la técnica de detectar CoV-2?, para esta pregunta hay que ser estricto en la respuesta, personalmente esta respuesta recae en opciones binarias, <em>Si</em> o <em>No</em>. Algunas muestras provenientes de sitios donde no hay mucho contacto piel-superficie, por ejemplo, los asientos de paradero, existe menor probabilidad de contacto directo en la superficie para impregnar con el virus. Justamente en esas muestras existe una menor cantidad de lecturas que mapean contra el genoma de referencia, llegando a tener una cobertura y profundidad de aproximadamente 2 a 3x pudiéndose considerar un posible artefacto si es que se tuviera un control ideal para poder descartarlo. Es en este punto donde entra la complejidad de asignar o no la acción de detección, principalmente en poder contestar las siguientes dos preguntas, si es posible reconstruir el genoma e identificar el linaje. Como estos metatranscriptomas no cuentan con un control libre de virus, no queda opción de responder a la primera pregunta con un <u><strong>SI</strong> se pudo detectar CoV-2 en las muestras</u> (Anotación en Tabla 3) pero no es posible garantizar ni precisar o descartar que tipo de CoV-2 es en aquellas muestras de baja cobertura o si estamos presente a un artefacto en dichos objetos de estudio.</p>
<p>Con una vision un poco mas epidemiológica, la reconstrucción e identificación del linaje de CoV-2 asociado a las muestras debe tomar exigencia para saber fehacientemente si los datos recopilados por el mapeo son considerados buenos para poder evaluar correctamente a las muestras, es por esto que se basa este criterio en lo que considera <em>&quot;un genoma reconstruido&quot;</em> por GISAID, quien se encarga de asignar clados y evalúa la integridad de un genoma de CoV-2. GISAID considera un genoma completo a aquel que mínimo contenga mas de 29'000 pb (sin contar Ns) y sea tenga menos de un 1,0 % de Ns, además consideran un estándar de bajo, normal y alta cobertura del genoma, precisando aquellos genomas de alta cobertura que cumplan con &lt; 1,0% de Ns y sin indels, aquellos genomas con baja cobertura que están sobre el 5% de Ns. Con estos estándares cumplieron 14 de 20 secuencias de CoV-2, siendo descartadas el resto para los análisis filogenómicos. De esta manera es <u><strong>SI</strong> fue posible reconstruir los genomas</u> con un estándar considerablemente bueno, ~0,04% &lt; Ns &gt; ~4,4% (12 Genomas completos de alta cobertura), teniendo confianza de estos datos se determino linaje y clado al que pertenecen las secuencias, mediante pangolin, llama y GISAID.</p>
<p>Pangolin asigno a todas las muestras como la variante B.1, teniendo como datos de tiempo de aparición entre finales de enero y principios de mayo, con paises mas comunes como Reino Unido, Estados Unidos y Australia, siendo la cepa mas común en Europa y la que corresponde al brote de Italia, teniendo una correlación lógica a la información de los primeros casos confirmados que llegaron a Santiago, personas con antecedentes de venir de viajes de Europa y principalmente de Italia, que termino siendo propagado por la ciudad y provocando el brote de esta variante.</p>
<p>Junto con Llama se identificaron los SNPs asociado a las variantes, de estas se asociaron en total 9 SNPs apreciándose en la figura 2, destacando 2 SNPs en el marco de lectura de que codifica para la proteína S (Tabla 5), 1 en el marco abierto de lectura para la proteína no-estructural 3 (NS3) y para 8 (NS8) y 5 SNPs asociado al ORF1ab.
Al ir al detalle de cada uno de los SNPs, resalta a la luz que en contraste con lo referenciado en los archivos .VCF <a href="">Anexo archivos VCF</a> algunos SNPs anotados por pangolin y llama tienen una profundidad relativamente baja, por ejemplo, el SNPs de la muestra <strong>BC-0345797636</strong> en la posición 22248, que es la única muestra que lo posee, tiene una profundidad de secuenciación de 4 y cambia un T por A al codon T<strong>T</strong>G para leucina por un codo T<strong>A</strong>G que corresponde a un stop, para llegar a corroborar este SNPs habría que secuenciar al espécimen (siendo imposible) o que la secuenciación tenga mayor profundidad en ese SNPs. Por lo que lo que representa llama en su infografía hay que corroborarlo manualmente para poder discernir objetivamente que dichos SNPs tengan al menos un valor mayor o igual al promedio de la profundidad obtenida para cada muestra.</p>
<p>En cambio, GISAID utiliza su bases de datos para determinar SNPs y asignar uno de los 7 clados con los que clasifica CoV-2. Segun su clasificación todos le asigno el clado <strong>GH</strong> a excepción de 4 genomas que asigno como <strong>OTHER</strong> que en sucesion son los 4 con menor profundidad y cobertura de secuenciación (~13 a ~41x de profundidad). Por lo que en respuesta de que si es posible determinar linaje, <strong>SI</strong> es posible determinar linaje, pero dependiendo de las calidades de secuenciación como profundidad y cobertura si no son los adecuados puede generar malas interpretaciones, por lo que es necesario un depurado y tener la exigencia en vincular correctamente los datos generados por bcftools, pangolin y llama para generar una conclusion correcta en la asignación de los SNPs y asociarlo con el linaje correspondiente.</p>
<center>
<p><img src="https://cdn.discordapp.com/attachments/739926071755145350/786615696494166026/llama.png" alt="IMAGEN"></p>
<p><strong>Figura 2. Infografía resultado de Llama.</strong> Las muestras están anotadas a la derecha, las posiciones de los SNPs detectados en la parte superior, la referencia se muestra en la parte inferior representado a la posición del genoma. Los nucleótidos <strong>A</strong>, <strong>C</strong>, <strong>T</strong>, <strong>G</strong> se representan en colores azul, rojo, verde celeste, en cambio <strong>R</strong> e <strong>Y</strong> en gris anotándose solo aquellas diferencias contra la referencia. En total fueron detectados 9 SNPs en conjunto con todos los datos.</p>
</center>
<center>
<p><strong>TABLA 5. SNPs de muestras contra la referencia.</strong> Gen afectado y nombre de la proteína</p>
<table>
<thead>
<tr>
<th>POSICION</th>
<th>GEN</th>
<th>PROTEINA</th>
</tr>
</thead>
<tbody>
<tr>
<td>1059</td>
<td><em>ORF1ab</em></td>
<td>NSP2</td>
</tr>
<tr>
<td>3037</td>
<td><em>ORF1ab</em></td>
<td>NSP3</td>
</tr>
<tr>
<td>8782</td>
<td><em>ORF1ab</em></td>
<td>NSP4</td>
</tr>
<tr>
<td>14408</td>
<td><em>ORF1ab</em></td>
<td>RNA-POL DEP-RNA</td>
</tr>
<tr>
<td>18877</td>
<td><em>ORF1ab</em></td>
<td>3'-5'EXONUCLEASA</td>
</tr>
<tr>
<td>22248</td>
<td><em>S</em></td>
<td>Glicoroteina Spike</td>
</tr>
<tr>
<td>23403</td>
<td><em>S</em></td>
<td>Glicoroteina Spike</td>
</tr>
<tr>
<td>25563</td>
<td><em>ORF3</em></td>
<td>NS3</td>
</tr>
<tr>
<td>28144</td>
<td><em>ORF8</em></td>
<td>NS8</td>
</tr>
</tbody>
</table>
</center>
<p>En contraparte, para poder visualizar la distancia evolutiva de las muestras con respecto al resto de las de Santiago al principio del pandemia se construyo un árbol filogenómico incluyendo las muestras de los metatranscriptomas que lograron los estándares de determinar la reconstrucción del genoma y clasificarlos al linaje correspondiente.
Todas las muestras se agrupan en el clado correspondiente al GH por GISAID, incluyendo una muestra de Santiago (ID GISAID). El clado formado se agrupa entre los que corresponden a GR y G, bien delimitados lo que estaría explicando como este se le atribuye la variante designada. Además, es posible rescatar la información temporal pudiendo correlacionar fechas de aparición de las variante, que se explicara mas en detallas posteriormente.</p>
<center>
<p><img src="https://cdn.discordapp.com/attachments/739926071755145350/786615698976931908/phy_tree.png" alt="IMAGEN"></p>
<p><strong>Figura 3. Representación de árbol filogenómico de CoV-2 de muestras de metatranscriptómica junto con muestras GISAID de Santiago 03-2020/04-2020</strong>. En color beige se encuentran las muestras asociadas a los metatranscriptomas. El archivo .tree se encuentra en <a href="./anexos/tree.html">Anexo Arboles Filogeneticos</a></p>
</center>
<p>Analizando finalmente las 10 muestras restantes (Aquellas de genomas completos e identificando y cerciorando clado y linaje), se pueden asociar ahora con la metadata compilada expuesta en la tabla 6 <a href="dir">Anexo Metadata Tabla con todas las muestras</a>. Con ello podemos identificar aquellas muestras donde abundan, que superficie y sitio donde se encuentran presente. Se puede observar que el virus se encuentran todos en superficies metálicas, salvo la muestra <em>BC-0345797645</em> el cual no se tiene algún tipo de información asociada al espécimen y tipo de superficie que fue extraída la muestra asociándola como tipo control. Tambien es posible rescatar que aquellas zonas de interior como lo es el banco (<em>BC-0345797802</em>) y centro medico (<em>BC-0361053744</em> y <em>BC-0361057091</em>) poseen una profundidad promedio de secuenciación sobre los 180x muy probablemente a que el cajero y las manillas de puerta se encontraran en un ambiente libre de radiación y a una temperatura optima para el virus. En cambio, el resto de las muestras que se encuentra en superficie y en subterránea o están expuestos a la radiación  solar (superficie) o altas temperaturas lo que provocaría que el CoV-2 no sobreviera mucho a esa exposiciones reduciendo su presencia en la muestra. Las características de que el virus sobrevive y se transmite mejor con ciertos contactos a tipos de superficie, humedad, temperatura y tiempo antes de llegar al hospedero humano ha sido reportado (<a href="https://doi.org/10.1016/j.matt.2020.10.006">Xue X., et al 2020</a>, <a href="https://doi.org/10.1016/S2666-5247(20)30003-3">Chin A.W.H., et al 2020</a>, <a href="https://doi.org/10.1038/s41598-020-69286-3">Santarpia J.L., 2020</a>), coincidiendo con las características reportadas.</p>
<center>
<p><strong>Tabla 6. Compilado de las muestras seleccionadas.</strong></p>
<table>
<thead>
<tr>
<th><strong>Muestra</strong></th>
<th><strong>Fecha</strong></th>
<th><strong>Comuna</strong></th>
<th><strong>Sitio</strong></th>
<th><strong>Especimen</strong></th>
<th><strong>Tipo de Superficie</strong></th>
<th><strong>Cobertura</strong></th>
<th><strong>Profundidad Promedio</strong></th>
<th><strong>Status GISAID</strong></th>
<th><strong>Linaje</strong></th>
<th><strong>Clado</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>BC-0345797632</em></td>
<td>2020-04-27</td>
<td>Puente Alto</td>
<td>PF176-Parada 3 / (M) Plaza De Puente Alto</td>
<td>Horizontal pole</td>
<td>Metal</td>
<td>40,458x</td>
<td>39.229x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797645</em></td>
<td>2020-04-18</td>
<td><em>Home</em> (Ñuñoa)</td>
<td><em>Home</em> (Control)</td>
<td>Control</td>
<td>Desconocido</td>
<td>2'832,4x</td>
<td>2'656.5x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797802</em></td>
<td>2020-04-20</td>
<td>Ñuñoa</td>
<td>Santander Bank</td>
<td>ATM</td>
<td>Metal</td>
<td>725,07x</td>
<td>703.12x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797815</em></td>
<td>2020-04-27</td>
<td>La Florida</td>
<td>Metro Bellavista de la Florida</td>
<td>ATM</td>
<td>Metal</td>
<td>51,855x</td>
<td>50.284x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345797817</em></td>
<td>2020-04-13</td>
<td>La Florida</td>
<td>Metro Bellavista de la Florida</td>
<td>ATM</td>
<td>Metal</td>
<td>92,894x</td>
<td>90.078x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345798943</em></td>
<td>2020-04-20</td>
<td>La Florida</td>
<td>PE1262-Parada 5 / (M)</td>
<td>Information board</td>
<td>Metal</td>
<td>19,969x</td>
<td>16.452x</td>
<td>Completo covertura normal</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0345799013</em></td>
<td>2020-04-27</td>
<td>Puenta Alto</td>
<td>PF512-Parada 2 / (M)</td>
<td>Horizontal pole</td>
<td>Metal</td>
<td>55,063x</td>
<td>53.398x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0361053718</em></td>
<td>2020-04-27</td>
<td>Macul</td>
<td>PD64-Parada 1 / Colegio San Marcos</td>
<td>Pole</td>
<td>Metal</td>
<td>50,981x</td>
<td>49.434x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0361053744</em></td>
<td>2020-04-20</td>
<td>Ñuñoa</td>
<td>Medical Center</td>
<td>Door handle</td>
<td>Metal</td>
<td>189,78x</td>
<td>181.11x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
<tr>
<td><em>BC-0361057091</em></td>
<td>2020-04-29</td>
<td>Ñuñoa</td>
<td>Medical Center</td>
<td>Door handle</td>
<td>Metal</td>
<td>184.48x</td>
<td>178.90x</td>
<td>Completo alta covertura</td>
<td>B.1</td>
<td>GH</td>
</tr>
</tbody>
</table>
</center>
<p>En Santiago el primer caso reportado por el Ministerio de Salud <a href="https://www.minsal.cl/ministerio-de-salud-confirma-tercer-caso-de-coronavirus-en-chile/">Reporte</a> fue el tercer a nivel nacional el día 4 de marzo del 2020, que correspondería a una persona que precisamente había viajado a Europa e Italia, considerando días de incubación del virus, para esa fecha Italia se encontraría en plena curva exponencial del brote asociado a la variante B.1 de CoV-2, lo mismo pasara para los siguientes confirmados para Santiago (muchos parientes de los primeros casos), la mayoría con antecedentes de haber viajado a Italia y Europa, ingresando a finales de febrero e inicio de marzo y que estuvieron en contacto directo con familiares o conocidos y fueron propagando el virus. Teniendo su inicio en las comunas del sector Oriente de Santiago (Las Condes y Vitacura). A partir del 25 de marzo se anunciaron por parte del Gobierno de Chile las cuarentenas, 20 días después del primer caso, para las comunas del sector oriente y centro de Santiago, afectando a Lo Barnechea, Vitacura, Las Condes, Providencia, Santiago, Ñuñoa e Independencia. Para finales de mes, según el informe epidemiológico de Covid-19 de marzo <a href="https://www.minsal.cl/wp-content/uploads/2020/03/INFORME_EPI_COVID19_20200330.pdf">Informe</a>, las comunas que fueron muestreadas presentaban los siguientes casos: La Florida: 43, Macul: 10, Ñunoa: 67, Puente Alto: 45. El 7 de abril, se decreta Puente Alto (La mitad poniente, donde se encuentra la muestra <em>BC-0345797632</em>) con 119 casos confirmados, La Florida y Macul entrarían el 7 de mayo a cuarentena con 578 y 181, en esa misma fecha Ñuñoa sale de cuarentena con 365 casos, para volver una semana después a cuarentena junto a toda la provincia de Santiago.
Con esta pequeña cronología de como el virus llego a la ciudad, es expando y las estrategias reportadas, anunciadas y publicadas por el Gobierno a través del Ministerio de Salud, posicionar las muestras en el mapa de Santiago, se puede observar que Ñuñoa que fue una de las primeras comunas en entrar a cuarentena fue siempre en las muestras seleccionadas, la que poseyó la mayor profundidad de secuenciación en comparación al resto, principalmente en la muestra asociada al cajero automático (<em>BC-0345797802</em>) utilizado frecuentemente por las personas y en un recinto que cumpliría con las condiciones para que el virus se pueda mantener por mas tiempo latente. Las muestras de Puente Alto, dos paraderos separados por la avenida Concha y Toro, utilizada para demarcar la cuarentena dinámica, una en el lado poniente con en cuarentena y el otro en el lado oriente en Jose Luis Coo, da a entender que el virus no respeta dicha delimitación, ni menos geográfica, el Virus esta presente en una profundidad similar a 20 días de decretada la cuarentena segmentada para Puente Alto. Para el caso de Macul (<em>BC-0361053718</em>)  que entro casi al final para la cuarentena para la provincia de Santiago, la muestra es de un paradero de transporte publico cercana a un colegio, San Marcos, la suspensión de actividades de jardines infantiles y colegios, públicos, subvencionados y privados se inicio el 15 de marzo. Por lo que a la toma de muestra el paradero no estaba a su máximo uso por los escolares en horario punta, aun así es considerablemente similar a las tomas de muestra de los paraderos de Puente Alto, consideran el espécimen que fue poste posa manos donde existe mayor probabilidad de contacto directo al virus con las manos, <strong>estableciendo una correlación entre posición de la ciudad con respecto al virus</strong>, siendo Puente Alto, La Florida y Macul comunas de preferencia residencial para el trabajo en comunas mas céntricas y del oriente de Santiago. La prohibición de trabajo en comunas de cuarentena se implemento posterior a la cuarentena total de la provincia de Santiago, por lo que el virus tuvo en total, mas de dos meses para circular por la ciudad antes del inicio del brote o primera ola.</p>
</div>
<h2 id="referencias">REFERENCIAS</h2>
<p><a href="#tabla-de-contenidos">Volver a Tabla de Contenidos</a></p>
<ul>
<li><strong>Chin, A., Chu, J., Perera, M., Hui, K., Yen, H. L., Chan, M., Peiris, M. &amp; Poon, L. (2020)</strong>. Stability of SARS-CoV-2 in different environmental conditions. <em>medRxiv</em>.</li>
<li><strong>Santarpia, J. L., Rivera, D. N., Herrera, V. L., Morwitzer, M. J., Creager, H. M., Santarpia, G. W., Crown, K. K., Brett-Major, D. M., Schnaubelt, E. R., Boradhurst, M. J., Lawler, J. V., Reid, P. &amp; Lawler, J. V. (2020)</strong>. Aerosol and surface contamination of SARS-CoV-2 observed in quarantine and isolation care. <em>Scientific reports</em>, 10(1), 1-8.</li>
<li><strong>Xue, X., Ball, J. K., Alexander, C., &amp; Alexander, M. R. (2020)</strong>. All surfaces are not equal in contact transmission of SARS-CoV-2. <em>Matter</em>.</li>
</ul>
<h2 id="anexos">ANEXOS</h2>
<h4 id="codigos-bash"><a href="./anexos/codigos.html">CODIGOS BASH</a></h4>
<h4 id="resumenes-estadisticos-de-mapeo"><a href="./anexos/stats.html">RESUMENES ESTADISTICOS DE MAPEO</a></h4>
<h4 id="mapas-de-coberturas"><a href="./anexos/Mapa.html">MAPAS DE COBERTURAS</a></h4>
<h4 id="estadisticos-tracer"><a href="./anexos/tracer.html">ESTADISTICOS TRACER</a></h4>
<h4 id="arboles-filogeneticos"><a href="./anexos/tree.html">ARBOLES FILOGENETICOS</a></h4>

    </body>
    </html>
